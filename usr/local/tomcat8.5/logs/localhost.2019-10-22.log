22-Oct-2019 13:49:04.265 严重 [http-nio-8181-exec-7] org.apache.catalina.core.StandardWrapperValve.invoke Servlet.service() for servlet [SpringMVC] in context with path [/lab-1.0-SNAPSHOT] threw exception [Request processing failed; nested exception is org.springframework.dao.RecoverableDataAccessException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 82,074,710 milliseconds ago.  The last packet sent successfully to the server was 82,074,712 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.
### The error may exist in file [/usr/local/tomcat8.5/webapps/lab-1.0-SNAPSHOT/WEB-INF/classes/mapper/UserMapper.xml]
### The error may involve com.jie.dao.UserMapper.getDevices-Inline
### The error occurred while setting parameters
### SQL: select *     from myDevices,device      where         userId=? and device.deviceId=myDevices.deviceId
### Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 82,074,710 milliseconds ago.  The last packet sent successfully to the server was 82,074,712 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.
; SQL []; The last packet successfully received from the server was 82,074,710 milliseconds ago.  The last packet sent successfully to the server was 82,074,712 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.; nested exception is com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 82,074,710 milliseconds ago.  The last packet sent successfully to the server was 82,074,712 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.] with root cause
	java.net.SocketException: 断开的管道 (Write failed)
		at java.net.SocketOutputStream.socketWrite0(Native Method)
		at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)
		at java.net.SocketOutputStream.write(SocketOutputStream.java:155)
		at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
		at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)
		at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3964)
		at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2596)
		at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2776)
		at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2838)
		at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2082)
		at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1307)
		at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169)
		at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:59)
		at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:73)
		at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:60)
		at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:267)
		at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:137)
		at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:96)
		at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:77)
		at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:108)
		at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:102)
		at sun.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:358)
		at com.sun.proxy.$Proxy16.selectList(Unknown Source)
		at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:198)
		at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:119)
		at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:63)
		at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:52)
		at com.sun.proxy.$Proxy18.getDevices(Unknown Source)
		at com.jie.seriviceimpl.UserServiceimpl.getDevices(UserServiceimpl.java:84)
		at com.jie.controller.userController.getMyDevices(userController.java:106)
		at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:690)
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:945)
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:876)
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)
		at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:863)
		at javax.servlet.http.HttpServlet.service(HttpServlet.java:660)
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)
		at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:108)
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:528)
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)
		at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:678)
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:798)
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:810)
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1500)
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
		at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
		at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
		at java.lang.Thread.run(Thread.java:748)
